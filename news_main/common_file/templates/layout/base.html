{% load static %}
{% load cache %}
{% load thumbnail %}

<!DOCTYPE html>
<html>
	<head>
		<title>{% block title %}Главная{% endblock %} :: Новостной портал</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<!--[if lte IE 8]><script src="{% static 'news_portal/js/ie/html5shiv.js' %}"></script><![endif]-->
		<link rel="stylesheet" type="text/css" href="{% static 'news_portal/css/reset.css' %}">
		<link rel="stylesheet" href="{% static 'news_portal/css/main.css' %}" />
		<!--[if lte IE 9]><link rel="stylesheet" href="{% static 'news_portal/css/ie9.css' %}" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="{% static 'news_portal/css/ie8.css' %}" /><![endif]-->
		<style>


			li:hover {
			  cursor: pointer;
			}

			ul li ul {
			  visibility: hidden;
			  opacity: 0;
			  position: absolute;

			  margin-top: 1rem;
			  display: none;
			}

			ul li:hover > ul,
			ul li ul:hover {
			  visibility: visible;
			  opacity: 1;
			  display: block;
			}


			.dropbtn {
				background-color: #ffffff;
				color: white;
				padding: 16px;
				font-size: 16px;
				border: none;
				cursor: pointer;
			}

			/* The container <div> - needed to position the dropdown content */
			.dropdown {
				position: relative;
				display: inline-block;
			}

			/* Dropdown Content (Hidden by Default) */
			.dropdown-content {
				display: none;
				position: absolute;
				background-color: #ffffff;
				min-width: 160px;
				box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
				z-index: 1;
			}

			/* Links inside the dropdown */
			.dropdown-content a {
				color: black;
				padding: 12px 16px;
				text-decoration: none;
				display: block;
			}

			/* Change color of dropdown links on hover */
			.dropdown-content a:hover {background-color: #ffffff}

			/* Show the dropdown menu on hover */
			.dropdown:hover .dropdown-content {
				display: block;
			}

			/* Change the background color of the dropdown button when the dropdown content is shown */
			.dropdown:hover .dropbtn {
				background-color: #ffffff;
			}

		</style>
	</head>
	<body>

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					{% cache 300 navbar request.user.is_authenticated %}
					<header id="header">
						<h1><a href="{% url 'news_output:index' %}">Главная Страница</a></h1>
						{% if user.is_superuser %}
						<h1><a class="nav_sections" href="{% url 'admin:index' %}">Сайт администратора</a></h1>
						<h1><a class="nav_sections" href="{% url 'news_output:publication_user_auth' type_sort='default' user_id=user.id %}">Мои публикации</a></h1>
						{% endif %}
						<nav class="links" role="navigation">
							<ul style="position: absolute">
								{% for super__rubric in rubrics %}
								{% ifchanged super__rubric.super_rubric.pk %}
									<li class="dropdown"><a class="dropbtn">{{ super__rubric.super_rubric.name }}</a>
									<ul style="display: flex; flex-direction: column; margin-top: 16px" id="myDropdown" class="dropdown-content">
										{% for rubric in rubrics %}
												{% if rubric.super_rubric.pk == super__rubric.super_rubric.pk %}
												<li style="margin-left: 0; padding-left: 0; border-left: none"><a href="{{ rubric.get_absolute_url }}">{{ rubric.name }}</a></li>
												{% endif %}
										{% endfor %}
									</ul>
									</li>
								{% endifchanged %}
								{% endfor %}
								<li><a href="{% url 'news_output:news_add' %}">Добавить Новость</a></li>
							</ul>
						</nav>
						<nav class="main">
							<ul>
								<li class="search">
									<a class="fa-search" href="#search">Search</a>
									<form id="search" method="get" action="{% url 'news_output:search' %}">
										<input type="text" name="query" placeholder="Search" />
									</form>
								</li>
								{% if not user.is_authenticated %}
								<li class="auth">
									<a class="fa-user" href="{% url  'news_auth_registered:login' %}">Auth</a>
								</li>
								{% else %}
								<li class="menu">
									<a class="fa-user" href="#menu">Menu</a>
								</li>
								{% endif %}
							</ul>
						</nav>
					</header>
					{% endcache %}
				<!-- Menu -->
					<section id="menu">

						<!-- Search -->
							<section>
								<form id="search_auth_user" method="get" action="{% url 'news_output:search' %}">
									<input type="text" name="query" placeholder="Search" />
								</form>
							</section>

						<!-- Links -->
<!--							<section>-->
<!--								<ul class="links">-->
<!--									<li>-->
<!--										<a href="#">-->
<!--											<h3>Lorem ipsum</h3>-->
<!--											<p>Feugiat tempus veroeros dolor</p>-->
<!--										</a>-->
<!--									</li>-->
<!--									<li>-->
<!--										<a href="#">-->
<!--											<h3>Dolor sit amet</h3>-->
<!--											<p>Sed vitae justo condimentum</p>-->
<!--										</a>-->
<!--									</li>-->
<!--									<li>-->
<!--										<a href="#">-->
<!--											<h3>Feugiat veroeros</h3>-->
<!--											<p>Phasellus sed ultricies mi congue</p>-->
<!--										</a>-->
<!--									</li>-->
<!--									<li>-->
<!--										<a href="#">-->
<!--											<h3>Etiam sed consequat</h3>-->
<!--											<p>Porta lectus amet ultricies</p>-->
<!--										</a>-->
<!--									</li>-->
<!--								</ul>-->
<!--							</section>-->

						<!-- Actions -->
						{% if user.is_authenticated %}
							<section>
								<ul class="actions vertical">
									<li><a href="{% url 'news_auth_registered:password_change' %}" class="button big fit">Сменить пароль</a></li>
								</ul>
								<ul class="actions vertical">
									<li><a href="{% url 'news_auth_registered:profile_setting' %}" class="button big fit">Настройки профиля</a></li>
								</ul>
								<ul class="actions vertical">
									<li><a href="{% url 'news_output:users_info' slug=user.slug %}" class="button big fit">Мой профиль</a></li>
								</ul>
								<ul class="actions vertical">
									<li><a href="{% url 'news_auth_registered:conversations_list' %}" class="button big fit">Диалоги</a></li>
								</ul>
								<ul class="actions vertical">
									<li><a href="{% url 'news_auth_registered:logout' %}" class="button big fit">Выйти из личного кабинета</a></li>
								</ul>
							</section>
						{% else  %}
						{% endif %}


					</section>

				<!-- Main -->
					{% block content %}
					{% endblock %}
				<!-- Sidebar -->
					{% if auth != 0 %}
					<section id="sidebar" class="right_block_ad_main">
						<div>

								<!-- Intro -->
		<!--							<section id="intro">-->
		<!--								<a href="#" class="logo"><img src="{% static 'news_portal/images/logo.jpg' %}" alt="" /></a>-->
		<!--								<header>-->
		<!--									<h2>в разработке</h2>-->
		<!--									<p>Пока пусто</a></p>-->
		<!--								</header>-->
		<!--							</section>-->

								{% block content_author %}
								{% endblock %}

								<!-- Posts List -->
									<section>
										{% if news_week_more_views %}
										<h1>Популярное на этой неделе</h1>
										<ul class="posts">
											{% for news_week in news_week_more_views %}
											<li>
												<article>
													<header>
														<h3><a href="{% url 'news_output:detail' pk=news_week.pk %}">{{ news_week.title }}</a></h3>
														<time class="published" >{{ news_week.published|date:"d E Y" }}</time>
														<time class="published" >{{ news_week.published|date:"В H:i" }}</time>
													</header>
													{% if news_week.image == None or news_week.image == '' %}
													<a href="#" class="image featured"><img src="{% static 'news_portal/images/pic01.jpg' %}" alt="" /></a>
													{% else %}
													<a href="{% url 'news_output:detail' pk=news_week.pk %}" class="image featured"><img src="{% thumbnail news_week.image 'default' %}" alt="" /></a>
													{% endif %}
												</article>
											</li>
											{% endfor %}
										</ul>
										{% else %}
												<article>
													<h3>Видимо на это недели не было публикациий статей :(</h3>
												</article>
										{% endif %}
									</section>

								<!-- About -->
									<section class="blurb">
										<h2>О нас</h2>
										<p>Это сайт.</p>
										<p>Этот сайт, возможно, первый полноценный проект дениса.</p>
										<ul class="actions">
											<li><a href="#" class="button">Подробнее</a></li>
										</ul>
									</section>

								<!-- Footer -->
									<section id="footer">
										<ul class="icons">
											<li><a href="#" class="fa-twitter"><span class="label">Twitter</span></a></li>
											<li><a href="#" class="fa-facebook"><span class="label">Facebook</span></a></li>
											<li><a href="#" class="fa-instagram"><span class="label">Instagram</span></a></li>
											<li><a href="#" class="fa-rss"><span class="label">RSS</span></a></li>
											<li><a href="#" class="fa-envelope"><span class="label">Email</span></a></li>
										</ul>
										<p class="copyright">&copy; Untitled. Design: <a href="http://html5up.net">HTML5 UP</a>. Images: <a href="http://unsplash.com">Unsplash</a>.</p>
									</section>
						</div>
					</section>
					{% else %}
					{% endif %}


			</div>
			<footer id="footer_main">
				<div style="display: flex; justify-content: space-around; width: 45%; margin-top: 10px">
					<ul class="nav_sections" style="list-style-type: none" href="#">Ваш аккаунт
						<li>Войти</li>
						<li>Регистрация</li>
					</ul>
					{% if user.is_superuser %}
					<ul class="nav_sections" style="list-style-type: none" href="#">Разделы
						<li>Публикации</li>
						<li>Новости</li>
						<li>Хабы</li>
						<li>Компании</li>
						<li>Авторы</li>
					</ul>
					<ul class="nav_sections" style="list-style-type: none" href="#">Информация
						<li>Для авторов</li>
						<li>Для компании</li>
						<li>Документы</li>
						<li>Соглашение</li>
						<li>Конфинденциальность</li>
					</ul>
					{% endif %}
				</div>
				<div>
					<span>000</span>
				</div>
			</footer>

		<!-- Scripts -->
			<script src="{% static 'news_portal/js/jquery.min.js' %}"></script>
			<script src="{% static 'news_portal/js/skel.min.js' %}"></script>
			<script src="{% static 'news_portal/js/util.js' %}"></script>
			<!--[if lte IE 8]><script src="{% static 'news_portal/js/ie/respond.min.js' %}"></script><![endif]-->
			<script src="{% static 'news_portal/js/main.js' %}"></script>
			<script>
					/* When the user clicks on the button,
				toggle between hiding and showing the dropdown content */
				function myFunction() {
					document.getElementById("myDropdown").classList.toggle("show");
				}

				// Close the dropdown menu if the user clicks outside of it
				window.onclick = function(event) {
				  if (!event.target.matches('.dropbtn')) {

					var dropdowns = document.getElementsByClassName("dropdown-content");
					var i;
					for (i = 0; i < dropdowns.length; i++) {
					  var openDropdown = dropdowns[i];
					  if (openDropdown.classList.contains('show')) {
						openDropdown.classList.remove('show');
					  }
					}
				  }
				}
			</script>
			{% block js %}
			{% endblock %}

	</body>
</html>

